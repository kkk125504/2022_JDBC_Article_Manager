### Container 도입

1\) 문제점 

```java
private int action(Connection conn, Scanner sc, String cmd) {
		MemberController memberController = new MemberController(conn,sc);		
		ArticleController articleController = new ArticleController(conn,sc);
```

- 연결시마다 ( action() 을 실행할때마다 ) 새로 Controller들을 생성함

- 현재 controller 안에 필드로 service가 있고 service 안에 필드로 dao가있다. 각각 실행할때마다 생성되고있다.

- 이를 해결하기 위해 container 도입

2\) Container

```java
	public class Container {
	public static ArticleController articleController;
	public static MemberController memberController;
	public static ArticleService articleService;
	public static MemberService memberService;

	public static ArticleDao articleDao;
    public static MemberDao memberDao;

	public static Session session;

	public static Scanner sc;

	public static Connection conn;

	public static void init() {
		session = new Session();

		articleDao = new ArticleDao();
		memberDao = new MemberDao();

		articleService = new ArticleService();
		memberService = new MemberService();

		articleController = new ArticleController();
		memberController = new MemberController();
		}
}
```
- 각각의 controller , service , dao 를 init( ) 메소드를 통해 프로그램이 시작할때 생성하게 함

3\) conn을 Container.conn으로 전달

			try {
				conn = DriverManager.getConnection(url, "root", "");
				Container.conn = conn;
	
				int actionResult = action(cmd);
	
				if (actionResult == -1) {
					break;
				}

- 이전에는 conn 을 controller → service → dao로 생성자를 통해 전달하였지만
- DB연결 후 Container.conn 로 전달하여 (conn이 필요한) dao 에서는 Container.conn을 사용하게 하여 각각의 controller와 service들의 생성자로 conn이 필요 없어짐



### Main에서 에러메세지를 보여줄 수 있도록 처리

```java
	public static int update(Connection dbConn, SecSql sql) {
			int affectedRows = 0;
			PreparedStatement stmt = null;
		try {
			stmt = sql.getPreparedStatement(dbConn);
			affectedRows = stmt.executeUpdate();
		} catch (SQLException e) {
			throw new SQLErrorException("SQL 예외, SQL : " + sql, e);
```

- 위에 코드를 보면 update메소드 실행시 SQLException이 발생하면
- throw new SQLErrorException을 발생 시키고있다. 
- 이때  F6을 누르면 예외메시지를 알수 있지만 

```java
	try {
		new App().run();
	} catch (SQLErrorException e) {
			System.err.println(e.getMessage());
			e.getOrigin().printStackTrace();
	}
```

- Main에서 에러메시지를 console에 출력하도록 함
